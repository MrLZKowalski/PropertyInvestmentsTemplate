<section class="properties-section">
  <div class="properties-container">
    <header class="section-header">
      <div class="header-content">
        <h2>Dostƒôpne mieszkania</h2>
        <p class="subtitle">Znajd≈∫ swoje wymarzone mieszkanie</p>
      </div>
      <div class="filters">
        <button class="filter-btn" [class.active]="filter === 'all'" (click)="setFilter('all')">Wszystkie</button>
        <button class="filter-btn" [class.active]="filter === 'available'" (click)="setFilter('available')">Dostƒôpne</button>
        <button class="filter-btn" [class.active]="filter === 'reserved'" (click)="setFilter('reserved')">Zarezerwowane</button>
      </div>
    </header>
    <div class="properties-grid">
  <ng-container *ngFor="let property of filteredProperties; trackBy: trackById">
        <article class="property-card">
          <div class="property-image">
            <img [src]="property.imageUrl" [alt]="property.name">
            <div class="property-badge" [ngClass]="property.status">
              {{getStatusLabel(property.status)}}
            </div>
          </div>
          <div class="property-content">
            <h3>{{property.name}}</h3>
            <p class="location">
              <span class="icon">üìç</span> Piƒôtro {{property.floor}}
            </p>
            <div class="property-features">
              <div class="feature">
                <span class="icon">üí∞</span>
                <span class="value">{{property.currentPrice | currency:'PLN':'symbol':'1.0-0'}}</span>
              </div>
              <div class="feature">
                <span class="icon">üìè</span>
                <span class="value">{{property.area}} m¬≤</span>
              </div>
              <div class="feature">
                <span class="icon">üè†</span>
                <span class="value">{{property.rooms}} pokoje</span>
              </div>
            </div>
            <button class="details-btn" (click)="toggleDetails(property.id)">
              {{ expandedPropertyId === property.id ? 'Ukryj szczeg√≥≈Çy' : 'Szczeg√≥≈Çy' }}
            </button>
            <div *ngIf="expandedPropertyId === property.id" class="property-details-modal">
              <h4>Historia cen</h4>
              <table class="price-history-table">
                <thead>
                  <tr>
                    <th>Data</th>
                    <th>Cena</th>
                    <th>Cena za m¬≤</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let history of property.priceHistory">
                    <td>{{history.date}}</td>
                    <td>{{history.price | currency:'PLN':'symbol':'1.0-0'}}</td>
                    <td>{{history.pricePerSquareMeter | currency:'PLN':'symbol':'1.0-0'}}</td>
                  </tr>
                </tbody>
              </table>
              <h4>Dodatkowe koszty</h4>
              <ul class="additional-costs-list">
                <li *ngFor="let cost of property.additionalCosts">
                  <span class="cost-name">{{cost.name}}</span>:
                  <span class="cost-price">{{cost.price | currency:'PLN':'symbol':'1.0-0'}}</span>
                  <span class="cost-desc">({{cost.description}})</span>
                  <span *ngIf="cost.isOptional">(opcjonalne)</span>
                </li>
              </ul>
              <div class="details-close">
                <button (click)="toggleDetails(property.id)">Zamknij</button>
              </div>
            </div>
          </div>
        </article>
      </ng-container>
    </div>
  </div>
</section>